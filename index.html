<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>

	<!-- Meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Page title -->
	<title>Chiron: track thy mentees...</title>

	<!-- And favicon -->
	<link rel="icon" type="image/png" href="data:image/png;base64, foobar" />

	<!-- Style sheets -->
	<link rel="stylesheet" href="css/style.css" />
	<link href="http://fonts.googleapis.com/css?family=Armata" rel="stylesheet" />

	<!-- Lastly, scripts -->
	<script src="js/jquery.js"></script>
	<script src="js/bz.js"></script>

</head>

<body>
	<header>
		<h1>Chiron</h1>
		<h3>Track Thy Mentee...</h3>
		<form id="input">
			<img src="img/remo.png" id="logo" alt="ReMo Logo" />
			<input type="text" id="user" placeholder="BugZilla Username" value="" />
			<input type="password" id="pass" placeholder="BugZilla Password" value="" />
			<input type="text" id="mentor" placeholder="Mentor's BugMail" value="" />
			<br />
			<button id="trigger">Fetch!</button>
		</form>
	</header>
	<section id="output"></section>
	<footer></footer>

	<!-- Lazy Loadable JS -->
	<script>
	$("form").click(function (event) {
		event.preventDefault();
	});
	$("#trigger").click( function (event) {
		boog = bz.createClient({
			username: $("#user").val(),
			password: $("#pass").val()
		});

		boog.searchBugs({
				summary: "application form",
				email1: $("#mentor").val(),
				emailassigned_to1: 1,
				bug_status: ["ASSIGNED","RESOLVED"],
				product: "Mozilla Reps"
			}, function (error, bugs) {
				if (!error) {
					var node = "";
					for (var bug in bugs) {
						node += "<a href='http://bugzil.la/" + bugs[bug].id + "'>" +
						bugs[bug].summary.split("Application Form: ")[1] +
						" <b>[" + (bugs[bug].resolution || bugs[bug].status) +
						"]</b></a><br />";
					}
					$("section").html(node);
				}
			}
		);
	});
	</script>

</body>

</html>
